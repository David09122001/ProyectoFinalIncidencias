<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ProjecteFinal.Views.ViewDetalleIncidencia"
             Title="Detalles de Incidencia"
             BackgroundColor="#F0F4F8">
    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20" HorizontalOptions="Center">
            <!-- Título -->
            <Label Text="Detalles de la Incidencia" FontSize="26" FontAttributes="Bold" TextColor="#1F2937" HorizontalOptions="Center" />

            <!-- Campos generales -->
            <Frame BackgroundColor="White" CornerRadius="15" Padding="20" HasShadow="True" WidthRequest="600">
                <VerticalStackLayout Spacing="15">
                    <Label Text="Detalles Generales" FontSize="20" FontAttributes="Bold" TextColor="#1F2937" />

                    <BoxView HeightRequest="1" BackgroundColor="#E5E7EB" Margin="0,10,0,10" />

                    <Label Text="Estado" FontAttributes="Bold" TextColor="#6B7280" />
                    <Label Text="{Binding Incidencia.estado}" TextColor="#374151" />

                    <Label Text="Profesor Responsable" FontAttributes="Bold" TextColor="#6B7280" />
                    <Label Text="{Binding Profesor.nombre}" TextColor="#374151" />
                    <Label Text="{Binding Profesor.email}" TextColor="#9CA3AF" FontSize="12" />

                    <Label Text="Descripción Detallada" FontAttributes="Bold" TextColor="#6B7280" />
                    <Label Text="{Binding Incidencia.descripcionDetallada}" TextColor="#374151" />

                    <Label Text="Aula" FontAttributes="Bold" TextColor="#6B7280" />
                    <Label Text="{Binding Incidencia.aulaUbicacion}" TextColor="#374151" />

                    <Label Text="Fecha de la Incidencia" FontAttributes="Bold" TextColor="#6B7280" />
                    <Label Text="{Binding Incidencia.fechaIncidencia, StringFormat='{0:dd/MM/yyyy}'}" TextColor="#374151" />

                    <Label Text="Fecha de Resolución" FontAttributes="Bold" TextColor="#6B7280" IsVisible="{Binding Incidencia.fechaResolucion}" />
                    <Label Text="{Binding Incidencia.fechaResolucion, StringFormat='{0:dd/MM/yyyy}'}" TextColor="#374151" IsVisible="{Binding Incidencia.fechaResolucion}" />

                    <Label Text="Tiempo Invertido" FontAttributes="Bold" TextColor="#6B7280" />
                    <Label Text="{Binding Incidencia.tiempoInvertido}" TextColor="#374151" />

                    <Label Text="Observaciones" FontAttributes="Bold" TextColor="#6B7280" />
                    <Label Text="{Binding Incidencia.observaciones}" TextColor="#374151" />
                </VerticalStackLayout>
            </Frame>

            <!-- Adjuntos -->
            <Frame BackgroundColor="White" CornerRadius="15" Padding="20" HasShadow="True" WidthRequest="600">
                <VerticalStackLayout Spacing="15">
                    <Label Text="Adjuntos" FontSize="20" FontAttributes="Bold" TextColor="#1F2937" />

                    <BoxView HeightRequest="1" BackgroundColor="#E5E7EB" Margin="0,10,0,10" />

                    <CollectionView ItemsSource="{Binding Adjuntos}" HeightRequest="150" Margin="0,10,0,0">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid Padding="5" ColumnSpacing="10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Label Text="{Binding Nombre}" VerticalOptions="Center" Grid.Column="0" TextColor="#374151" />
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Frame>

            <!-- Especializaciones -->
            <Frame IsVisible="{Binding MostrarHW}" BackgroundColor="White" CornerRadius="15" Padding="20" HasShadow="True" WidthRequest="600">
                <VerticalStackLayout Spacing="15">
                    <Label Text="Detalles de Hardware" FontSize="20" FontAttributes="Bold" TextColor="#1F2937" />
                    <BoxView HeightRequest="1" BackgroundColor="#E5E7EB" Margin="0,10,0,10" />
                    <Label Text="Dispositivo" FontAttributes="Bold" TextColor="#6B7280" />
                    <Label Text="{Binding IncidenciaHW.dispositivo}" TextColor="#374151" />
                    <Label Text="Modelo" FontAttributes="Bold" TextColor="#6B7280" />
                    <Label Text="{Binding IncidenciaHW.modelo}" TextColor="#374151" />
                    <Label Text="Número de Serie" FontAttributes="Bold" TextColor="#6B7280" />
                    <Label Text="{Binding IncidenciaHW.numeroSerie}" TextColor="#374151" />
                </VerticalStackLayout>
            </Frame>

            <Frame IsVisible="{Binding MostrarSW}" BackgroundColor="White" CornerRadius="15" Padding="20" HasShadow="True" WidthRequest="600">
                <VerticalStackLayout Spacing="15">
                    <Label Text="Detalles de Software" FontSize="20" FontAttributes="Bold" TextColor="#1F2937" />
                    <BoxView HeightRequest="1" BackgroundColor="#E5E7EB" Margin="0,10,0,10" />
                    <Label Text="Sistema Operativo" FontAttributes="Bold" TextColor="#6B7280" />
                    <Label Text="{Binding IncidenciaSW.sistemaOperativo}" TextColor="#374151" />
                    <Label Text="Aplicación" FontAttributes="Bold" TextColor="#6B7280" />
                    <Label Text="{Binding IncidenciaSW.aplicacion}" TextColor="#374151" />
                </VerticalStackLayout>
            </Frame>

            <Frame IsVisible="{Binding MostrarRed}" BackgroundColor="White" CornerRadius="15" Padding="20" HasShadow="True" WidthRequest="600">
                <VerticalStackLayout Spacing="15">
                    <Label Text="Detalles de Red" FontSize="20" FontAttributes="Bold" TextColor="#1F2937" />
                    <BoxView HeightRequest="1" BackgroundColor="#E5E7EB" Margin="0,10,0,10" />
                    <Label Text="Dispositivo Afectado" FontAttributes="Bold" TextColor="#6B7280" />
                    <Label Text="{Binding IncidenciaRed.dispositivoAfectado}" TextColor="#374151" />
                </VerticalStackLayout>
            </Frame>
            
            <!-- Botón Generar Informe -->
            <Button Text="Generar Informe"
                    Style="{StaticResource PrimaryButtonStyle}"
                    WidthRequest="200"
                    Command="{Binding GenerarInformeCommand}" />

            <!-- Botón Volver -->
            <Button Text="Volver" Clicked="OnVolverClicked" Style="{StaticResource PrimaryButtonStyle}" WidthRequest="200" Margin="0,20,0,0" />
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
